WITH RECURSIVE date_range AS (
  SELECT CAST(? AS DATE) AS BUSINESS_DATE FROM dual
  UNION ALL
  SELECT BUSINESS_DATE - 1 FROM date_range WHERE NOT EXISTS (SELECT 1 FROM OFFICE WHERE BUSINESS_DATE = date_range.BUSINESS_DATE - 1)
)
SELECT BUSINESS_DATE
FROM date_range
WHERE EXISTS (SELECT 1 FROM OFFICE WHERE BUSINESS_DATE = date_range.BUSINESS_DATE)
AND ROWNUM = 1;
